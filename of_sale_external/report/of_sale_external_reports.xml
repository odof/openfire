<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Rapport Impression spécifique -->

    <!-- Modification des pdf devis/commande -->
    <template id="of_external_saleorder_document" inherit_id="sale.report_saleorder_document">
        <div name="addresses" position="after">
            <div name="date_and_name" t-if="doc.company_id.of_position_header_lines == 'bandeau_totalite' and doc.company_id.of_display_pastille_as_title">
                <h3>
                    <span t-if="doc.state == 'draft'">Estimation</span>
                    <span t-if="doc.state == 'sent'">Devis</span>
                    <span t-if="doc.state not in ['draft','sent']">Bon de commande</span>
                    <span t-field="doc.name"/> du <span t-if="doc.state in ['sale', 'done'] and doc.confirmation_date" t-field="doc.confirmation_date" t-options="{'format': 'dd/MM/yyyy'}"/><span t-if="doc.state not in ['sale', 'done'] and doc.date_order" t-field="doc.date_order" t-options="{'format': 'dd/MM/yyyy'}"/>
                </h3>
            </div>
        </div>
    </template>

    <template id="saleorder_specific_external_layout_header" inherit_id="report.external_layout_header" primary="True">
        <xpath expr="//div[@name='doc_title']" position="replace">
            <div name="doc_title" style="font-size: large; text-align: center; padding: 4px 0px;">
                <strong>
                    <span t-field="o.of_specific_title"/>
                </strong>
            </div>
        </xpath>
        <xpath expr="//div[@name='champ_date']" position="replace">
            <div name="champ_date" style="text-align: right; float: right; display: inline-block;">
                <strong>
                    <span t-field="o.of_specific_date"/>
                </strong>
            </div>
        </xpath>
    </template>

    <template id="saleorder_specific_external_layout" inherit_id="report.external_layout" primary="True">
        <xpath expr="//t[@t-call='report.external_layout_header']" position="attributes">
            <attribute name="t-call">of_sale_external.saleorder_specific_external_layout_header</attribute>
        </xpath>
    </template>

    <template id="report_saleorder_specific_document" inherit_id="sale.report_saleorder_document" primary="True">
        <xpath expr="//t[@t-call='report.external_layout']" position="attributes">
            <attribute name="t-call">of_sale_external.saleorder_specific_external_layout</attribute>
        </xpath>
    </template>

    <template id="report_saleorder_specific">
        <t t-call="report.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="of_sale_external.report_saleorder_specific_document" t-lang="doc.partner_id.lang"/>
            </t>
        </t>
    </template>

    <report
        id="of_sale_saleorder_specific_report"
        string="Impression spécifique"
        model="sale.order"
        report_type="qweb-pdf"
        file="of_sale_external.report_saleorder_specific"
        name="of_sale_external.report_saleorder_specific"
    />

</odoo>
