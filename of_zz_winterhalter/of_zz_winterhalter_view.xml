<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

<!-- *************************************************** -->        
<!-- ****************** PARC INSTALLÉ ****************** -->
<!-- *************************************************** -->

		<!-- Parc installé filtre -->    
		<record id="of_parc_installe_search_view" model="ir.ui.view">
		    <field name="name">of.parc.installe.search</field>
		    <field name="model">of.parc.installe</field>
		    <field name="arch" type="xml">
		        <search string="Parc installé">
		            <field name="name"/>
		            <field name="product_id"/>
		            <field name="client_id"/>
		            <field name="tel_site_id"/>
		            <field name="date_service"/>
		            <field name="revendeur_id"/>
		            <group expand="0" string="Regrouper par">
		               <filter string="Client" icon="terp-personal" context="{'group_by' : 'client_id'}"/>
		               <filter string="Produit" icon="terp-personal" context="{'group_by' : 'product_id'}"/>
		               <filter string="Revendeur" icon="terp-personal" context="{'group_by' : 'revendeur_id'}"/>                  
		            </group>
		        </search>
		    </field>
		</record>

        <!-- Parc installé tree -->
        <record id="of_parc_installe_tree_view" model="ir.ui.view">
            <field name="name">of.parc.installe.tree</field>
            <field name="model">of.parc.installe</field>
            <field name="arch" type="xml">
                <tree string="Parc installé">
                    <field name="client_id"/>                    
                    <field name="product_id"/>
                    <field name="name"/>
                    <field name="site_adresse_id"/>
                    <field name="revendeur_id"/>
                    <field name="installateur_id"/>
                </tree>
            </field>
        </record>

        <!-- Parc installé form -->
        <record id="of_parc_installe_form_view" model="ir.ui.view">
            <field name="name">of.parc.installe.form</field>
            <field name="model">of.parc.installe</field>
            <field name="arch" type="xml">
	            <form>
	            	<group>
		            	<group name="cient" string="Client">
		            		<field name="client_id"/>
		            		<label for="site_adresse_id" string="Site installation"/>
			                <div>
			                    <field name="site_adresse_id" nolabel="1" context="{'show_address': True}"/>
				                <field name="street_site_id" nolabel="1"/>
				                <field name="street2_site_id" nolabel="1"/>
				                <field name="zip_site_id" style="width: 20%" nolabel="1"/>
				                <field name="city_site_id" style="width: 40%" nolabel="1"/>
				                <field name="country_site_id" nolabel="1"/>
				                <field name="tel_site_id" nolabel="1"/>
				            </div>
			            </group>
			            <group name="pose" string="Pose">
			           		<field name="revendeur_id"/>
			                <field name="installateur_id"/>
			                <!-- <field name="installateur_adresse_id" context="{'show_address': True}"/> -->             
			            </group>
			        </group>
			        <group name="produit_installe" string="Produit installé">
			            <group name="produit">
			                <field name="product_id"/>
			                <field name="name"/>
                            <field name="product_category_id"/>
			                <field name="date_service"/>
			                <field name="date_installation"/>
			                <field name="no_piece"/>
			            </group>
			            <group name="produit_infos_supp">
			          		<field name="chiffre_aff_ht"/>
			                <field name="quantite_vendue"/>
			                <field name="marge"/>
			            </group>
		            </group>
		            <group>
		            	<field name="note"/>
		            </group>
		            <group name="sav" string="Historique de la machine">
		                <field name="project_issue_ids" nolabel="1" context="{'default_partner_id':id}">
		                    <tree string="SAV">
		                        <field name="of_code" string="Dossier"/>
		                        <field name="date"/>
		                        <field name="name" string="Requête"/>
		                        <field name="of_categorie_id" string="Famille"/>
		                        <field name="of_produit_installe_id" string="S/N"/>
		                        <field name="user_id" string="Responsable"/>
		                        <field name="of_actions_realisees"/>
		                        <field name="stage_id"/>
		                        <button name="button_open_of_sav" class="oe_link" type="object" string="Ouvrir"/>
		                    </tree>
		                </field>
                	</group>
	            </form>
            </field>
        </record>


<!-- *************************************************** -->        
<!-- *************** SAV (project.issue) *************** -->
<!-- *************************************************** --> 

        <!-- Ajout recherche par no de série de la machine installée -->
        <record id="of_view_project_issue_filter_win" model="ir.ui.view">
            <field name="name">of.view.project.issue.filter.win</field>
            <field name="model">project.issue</field>
            <field name="inherit_id" ref="project_issue.view_project_issue_filter"/>
            <field name="arch" type="xml">
                <field name="partner_id" position="after">
                    <field name="of_contact_sav"/>
                    <field name="of_tel_sav"/>
                    <field name="of_produit_installe_id" string="No série"/>
                    <field name="description" string="Problématique"/>
                </field>
            </field>
        </record>
        
        <!-- Ajout type de Sav dans vue trie -->
        <record id="of_project_issue_tree_win" model="ir.ui.view">
            <field name="name">SAV Support</field>
            <field name="model">project.issue</field>
            <field name="type">tree</field>
            <field name="inherit_id" ref="of_project_issue.of_crm_case_tree_view_helpdesk"/>
            <field name="arch" type="xml">
                <field name="of_code" position="after">
                    <field name="of_type"/>
                </field>
            </field>
        </record>
        
        
        
		<!-- insertion Produit installé lié et champs supplémentaires Winterhalter dans SAV -->
		<record id="of_produit_installe_sav_lie" model="ir.ui.view" >
		    <field name="name">of.produit_installe.sav.lie</field>
		    <field name="model">project.issue</field>
		    <field name="inherit_id" ref="project_issue.project_issue_form_view"/>
		    <field name="arch" type="xml" >
		    	<field name="date" position="after">
		    		<field name="of_type"/>
		    	</field>
		    	<field name="user_id" position="replace">
		    		<field name="user_id" string="Responsable"/>
		    	</field>
                <field name="tag_ids" position="after">
                    <field name="of_contact_sav"/>
                    <field name="of_tel_sav"/>
                </field>                
		    	<xpath expr='//form/sheet/group' position="after">
		            <group string="Produit installé" colspan="4">
		            	<field name="of_produit_installe_id" string="No de série" on_change="on_change_of_produit_installe_id(of_produit_installe_id)"/>
		            	<field name="product_name_id" on_change="on_change_product_name_id(of_produit_installe_id)"/>
		            	<field name="product_category_id"/>
		            </group>
		        </xpath>
		        <field name="of_canal_id" position="replace"/>
		        <field name="of_garantie" position="replace"/>
                <field name="of_payant_client" position="replace"/>
                <field name="of_payant_fournisseur" position="replace"/>
		        <field name="description" position="replace">
		        	<field name="description" string="Problématique"/>
		        </field>
		        <field name="of_piece_commande" position="replace">
		        	<field name="of_actions_realisees"/>
		        </field>
		        <field name="of_intervention" position="replace">
		        	<field name="of_actions_eff"/>
		        </field>
		        
		    </field>
		</record>


		<!-- Rapport Fiche SAV Winterhalter (en remplacement de la fiche SAV de of_project_issue) -->
		<report
            auto="True" 
            id="of_project_issue.report_of_project_issue"
            model="project.issue"
            name="of_project_issue.sav_winterhalter"
            rml="of_zz_winterhalter/report/sav.rml"
            string="Fiche SAV"
            header="False"/>



<!-- *************************************************** -->        
<!-- ********** VUE PARTENAIRES (res.partner) ********** -->
<!-- *************************************************** -->

        <!-- Vue partenaire filtre recherche ajout recherche par réf client -->
        <record id="of_res_partner_filter" model="ir.ui.view">
            <field name="name">of.res.partner.filter</field>
            <field name="model">res.partner</field>
            <field name="type">search</field>
            <field name="inherit_id" ref="base.view_res_partner_filter"/>
            <field name="arch" type="xml">
            	<field name="name" position="after">
		            <field name="ref" string="Référence"/>
				</field>
            </field>
        </record>
        
		<!-- Ajouter référence client dans liste partenaires -->
		<record id="of_res_partner_winterhalter_tree" model="ir.ui.view">
		   	<field name="name">of.res.partner.winterhalter.tree</field>
		    <field name="model">res.partner</field>
		    <field name="type">tree</field>
		    <field name="inherit_id" ref="base.view_partner_tree" />
		    <field name="arch" type="xml">
		      	<field name="display_name" position="before">
		            <field name="ref" string="Référence"/>
				</field>
		    </field>
		</record>
		
		<!-- Mettre revendeur, installateur, payeur, référence client en haut dans formulaire partenaires
        ajout onglet lieu de livraison et changer vue contacts kanban en vue liste-->
        <record id="of_res_partner_winterhalter_form" model="ir.ui.view">
            <field name="name">of.res.partner.winterhalter.form</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.view_partner_form"/>
            <field name="arch" type="xml">
                <field name="user_id" position="after">
                    <field name="of_revendeur"/>
                    <field name="of_installateur"/>
                </field>
                <field name="website" position="after">
                    <field name="of_payeur_id" attrs="{'invisible': [('parent_id','!=', False)]}"/>
                </field>
                <field name="ref" position="replace"/>
                <field name="type" position="before">
                    <field name="ref" string="Référence" attrs="{'invisible': [('parent_id','!=', False)]}"/>
                </field>
                <field name="lang" position="after">
                    <field name="of_ape"/>
                </field>
                <field name="child_ids" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <xpath expr='//form/sheet/notebook/page' position="attributes">
                    <attribute name="string">Contacts</attribute>
                </xpath>
                <field name="child_ids" position="after">
                    <field name="contact_ids" nolabel="1" attrs="{'invisible': [('parent_id','!=', False)]}"
                        context="{'default_parent_id': active_id, 'default_street': street, 'default_street2': street2, 'default_city': city, 'default_state_id': state_id, 'default_zip': zip, 'default_country_id': country_id, 'default_supplier': supplier, 'default_customer': customer, 'default_lang': lang,}">
                        <tree string="Contact">
                            <field name="display_name"/>
                            <field name="function"/>
                            <field name="type"/>
                            <field name="contact_address"/>
                        </tree>
                        <form string="Contact / Address">
                            <sheet>
                                <field name="type" required="1" widget="radio" options="{'horizontal': true}"/>
                                <hr/>
                                <group>
                                    <group attrs="{'invisible': [('type','=', 'contact')]}">
                                        <label for="street" string="Address"/>
                                        <div>
                                            <div class="o_address_format" name="div_address">
                                                <field name="street" placeholder="Street..." class="o_address_street"/>
                                                <field name="street2" placeholder="Street 2..." class="o_address_street"/>
                                                <field name="city" placeholder="City" class="o_address_city"/>
                                                <field name="state_id" class="o_address_state" placeholder="State" options="{&quot;no_open&quot;: True}" on_change="onchange_state(state_id)" context="{'country_id': country_id, 'zip': zip}"/>
                                                <field name="zip" placeholder="ZIP" class="o_address_zip"/>
                                                <field name="country_id" placeholder="Country" class="o_address_country" options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}"/>
                                            </div>
                                        </div>
                                    </group>
                                    <group>
                                        <field name="name" string="Contact Name" attrs="{'required' : [('type', '=', 'contact')]}"/>
                                        <field name="title" placeholder="e.g. Mr." attrs="{'invisible': [('type','&lt;&gt;', 'contact')]}"/>
                                        <field name="function" placeholder="e.g. Sales Director" attrs="{'invisible': [('type','&lt;&gt;', 'contact')]}"/>
                                        <field name="email"/>
                                        <field name="phone" widget="phone"/>
                                        <field name="mobile" widget="phone"/>
                                        <field name="comment" placeholder="internal note..."/>
                                    </group>
                                </group>
                                <field name="supplier" invisible="True"/>
                                <field name="customer" invisible="True"/>
                                <field name="lang" invisible="True"/>
                            </sheet>
                        </form>
                    </field>
                </field>
                <page name="internal_notes" position="before">
                    <page name="contact_livraison" string="Livraisons" attrs="{'invisible': [('parent_id','!=', False)]}">
                        <field name="livraison_ids" nolabel="1"
                            context="{'default_parent_id': active_id, 'default_street': street, 'default_street2': street2, 'default_city': city, 'default_state_id': state_id, 'default_zip': zip, 'default_country_id': country_id, 'default_supplier': supplier, 'default_customer': customer, 'default_lang': lang,}">
                            <tree string="Lieu livraison">
                                <field name="display_name"/>
                                <field name="function"/>
                                <field name="type"/>
                                <field name="contact_address"/>
                            </tree>
                            <form string="Contact / Address">
                                <sheet>
                                    <field name="type" required="1" widget="radio" options="{'horizontal': true}"/>
                                    <hr/>
                                    <group>
                                        <group attrs="{'invisible': [('type','=', 'contact')]}">
                                            <label for="street" string="Address"/>
                                            <div>
                                                <div class="o_address_format" name="div_address">
                                                    <field name="street" placeholder="Street..." class="o_address_street"/>
                                                    <field name="street2" placeholder="Street 2..." class="o_address_street"/>
                                                    <field name="city" placeholder="City" class="o_address_city"/>
                                                    <field name="state_id" class="o_address_state" placeholder="State" options="{&quot;no_open&quot;: True}" on_change="onchange_state(state_id)" context="{'country_id': country_id, 'zip': zip}"/>
                                                    <field name="zip" placeholder="ZIP" class="o_address_zip"/>
                                                    <field name="country_id" placeholder="Country" class="o_address_country" options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}"/>
                                                </div>
                                            </div>
                                        </group>
                                        <group>
                                            <field name="name" string="Contact Name" attrs="{'required' : [('type', '=', 'contact')]}"/>
                                            <field name="title" placeholder="e.g. Mr." attrs="{'invisible': [('type','&lt;&gt;', 'contact')]}"/>
                                            <field name="function" placeholder="e.g. Sales Director" attrs="{'invisible': [('type','&lt;&gt;', 'contact')]}"/>
                                            <field name="email"/>
                                            <field name="phone" widget="phone"/>
                                            <field name="mobile" widget="phone"/>
                                            <field name="comment" placeholder="internal note..."/>
                                        </group>
                                    </group>
                                    <field name="supplier" invisible="True"/>
                                    <field name="customer" invisible="True"/>
                                    <field name="lang" invisible="True"/>
                                </sheet>
                            </form>
                        </field>
                    </page>
                </page>
                <group name="sav" position="replace">
                    <group name="sav" string="SAV">
                        <field name="project_issue_ids" nolabel="1" context="{'default_partner_id':id}">
                            <tree string="SAV">
                                <field name="of_code" string="Dossier"/>
                                <field name="date"/>
                                <field name="name" string="Requête"/>
                                <field name="of_categorie_id" string="Famille"/>
                                <field name="of_produit_installe_id" string="S/N"/>
                                <field name="user_id" string="Responsable"/>
                                <field name="of_actions_realisees"/>
                                <field name="stage_id"/>
                                <button name="button_open_of_sav" class="oe_link" type="object" string="Ouvrir"/>
                            </tree>
                        </field>
                    </group>
                </group>
            </field>
        </record>



<!-- *************************************************** -->        
<!-- ********* VUE PRODUITS (product.template) ********* -->
<!-- *************************************************** -->

		<!-- Produits : ajout produit dangereux et poids ADR (poids produit dangereux) -->
		<record id="of_product_template_winterhalter_form" model="ir.ui.view">
		    <field name="name">of.product.template.winterhalter.form</field>
		    <field name="model">product.template</field>
		    <field name="inherit_id" ref="product.product_template_only_form_view"/>
		    <field name="arch" type="xml">
		        <field name="default_code" position="after">
		        	<field name="of_produit_substitue_id"/>
		        	<field name="of_est_dangereux"/>
		        </field>
		        <div name="weight" position="after">
		        	<field name="of_poids_adr"/>
		        </div>
		    </field>
		</record>


<!-- *************************************************** -->        
<!-- ********************** MENUS ********************** -->
<!-- *************************************************** -->   
                
        <!-- Menu OpenService dans barre menu -->
		<menuitem id="menu_of_openservice" name="OpenService" sequence="0"/>
		
		<menuitem id="of_sous-menu_openservice" name="OpenService" parent="menu_of_openservice" sequence="5"/>
		<!-- Menu configuration catégories de produits -->
		<menuitem id="of_menu_config_openservice" name="Configuration" parent="menu_of_openservice" sequence="100"/>
		
		     
		<!-- Action vue parc installé -->
		<record id="action_view_of_parc_installe" model="ir.actions.act_window">
		     <field name="name">Parc installé</field>
		     <field name="type">ir.actions.act_window</field>
		     <field name="res_model">of.parc.installe</field>
		     <field name="view_type">form</field>
		     <field name="view_mode">tree,form</field>
		     <field name="search_view_id" ref="of_parc_installe_search_view"/>
		     <field name="help">Parc des produits installés</field>
		</record>

		<!-- Menu parc installé -->
		<menuitem id="menu_of_parc_installe" action="action_view_of_parc_installe" name="Parc installé" 
		     parent="of_sous-menu_openservice" groups="project.group_project_user" sequence="10"/>



		<!-- Menu SAV -->
	    <record model="ir.actions.act_window" id="of_project_issue_categ_act0">
	        <field name="name">SAV</field>
	        <field name="res_model">project.issue</field>
	        <field name="view_type">form</field>
	        <field name="view_mode">tree,kanban,form,pivot,graph</field>
	        <field name="view_id" ref="project_issue.project_issue_tree_view"/>
	        <field name="domain" eval=""/>
	        <!-- <field name="search_view_id" ref="view_project_issue_filter"/> -->
	        <field name="help" type="html">
	            <p>
	                The Odoo issues tacker allows you to efficiently manage things
	                like internal requests, software development bugs, customer
	                complaints, project troubles, material breakdowns, etc.
	            </p>
	        </field>
	    </record>

		<menuitem id="of_menu_project_issue_track"  parent="of_sous-menu_openservice" action="of_project_issue_categ_act0" groups="project.group_project_user" sequence="5"/>


		<!-- Menu Fournisseurs : on affiche ceux dont le champ supplier est vrai -->
		<record id="of_action_partner_supplier_form" model="ir.actions.act_window">
            <field name="name">Fournisseurs</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">res.partner</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form</field>
            <field name="domain">[('supplier','=',True)]</field>
            <field name="context">{}</field>
            <!-- <field name="search_view_id" ref="view_res_partner_filter"/> -->
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to add a contact in your address book.
              </p><p>
                Odoo helps you easily track all activities related to
                a customer; discussions, history of business opportunities,
                documents, etc.
              </p>
            </field>
        </record>
        
        <!-- Menu Clients : on affiche tous les partenaires qui ne sont pas des fournisseurs ou à la fois fournisseur et client -->
        <record id="of_action_partner_form" model="ir.actions.act_window">
            <field name="name">Clients</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">res.partner</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form</field>
            <field name="domain">['|',('supplier','=',False),('customer','=',True)]</field>
            <field name="context">{}</field>
            <!-- <field name="search_view_id" ref="view_res_partner_filter"/> -->
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to add a contact in your address book.
              </p><p>
                Odoo helps you easily track all activities related to
                a customer; discussions, history of business opportunities,
                documents, etc.
              </p>
            </field>
        </record>
        
        <menuitem id="of_menu_partner_form" parent="of_sous-menu_openservice" action="of_action_partner_form" sequence="15"/>
        <menuitem id="of_menu_partner_supplier_form" parent="of_sous-menu_openservice" action="of_action_partner_supplier_form" sequence="20"/>


		<!-- Menu Articles -->
		<record id="of_product_template_action" model="ir.actions.act_window">
            <field name="name">Articles</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">product.template</field>
            <field name="view_mode">tree,kanban,form</field>
            <field name="view_type">form</field>
            <!-- <field name="view_id" ref="product_template_kanban_view"/> -->
            <field name="context">{}</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to define a new product.
                </p><p>
                    You must define a product for everything you sell, whether it's a physical product, a consumable or a service you offer to  customers.               
                </p><p>
                    The product form contains information to simplify the sale process: price, notes in the quotation, accounting data, procurement methods, etc.
                </p>
            </field>
        </record>

		<menuitem id="of_menu_product_template_action" parent="of_sous-menu_openservice" action="of_product_template_action" sequence="25"/>
		
		
		<!-- Menu configuration catégories d'articles -->
        <record id="of_product_category_action_form" model="ir.actions.act_window">
            <field name="name">Catégories d'articles</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">product.category</field>
            <field name="view_type">form</field>
<!--             <field name="search_view_id" ref="product.product_category_search_view"/>
            <field name="view_id" ref="product.product_category_list_view"/> -->
        </record>
        
        <menuitem action="of_product_category_action_form"
            groups="project.group_project_manager"
            id="menu_of_product_category_action_form"
            parent="of_menu_config_openservice" sequence="2"/>

        <!-- Menu Planning configuration -->
        <menuitem id="of_menu_config_openservice_planning" name="Planning interventions" parent="of_menu_config_openservice" sequence="10" groups="of_planning.of_group_planning_pose_manager"/>

        <menuitem name="Employés" id="menu_hr_employee_tree_win" parent="of_menu_config_openservice_planning" sequence="10" action="of_planning.action_hr_employee_tree"/>
        <menuitem name="Equipes" id="menu_of_planning_equipe_tree_win" parent="of_menu_config_openservice_planning" sequence="20" action="of_planning.action_of_planning_equipe_tree"/>
        <menuitem name="Erreurs" id="menu_of_planning_pose_raison_tree_win" parent="of_menu_config_openservice_planning" sequence="30" action="of_planning.action_of_planning_pose_raison_tree"/>
        <menuitem name="Tâches" id="menu_of_planning_tache_tree_win" parent="of_menu_config_openservice_planning" sequence="40" action="of_planning.action_of_planning_tache_tree"/>
        
        <!-- Menus Planning -->
        <menuitem id="menu_of_planning_pose_pose_win" name="Planning des interventions" parent="of_sous-menu_openservice" sequence="8" action="of_planning.action_of_planning_pose_calendar" groups="of_planning.of_group_planning_pose_user"/>
            


<!-- *************************************************** -->        
<!-- ********************* ACTIONS ********************* -->
<!-- *************************************************** -->

		<!-- *** Action dans vue SAV (project.issue) *** -->
		
		<!-- Lien pour action créer SAV demande d'intervention depuis SAV -->
		<!-- Objectif : ouvrir un nouveau SAV depuis un SAV "Appel téléphonique" avec les mêmes paramètres mais avec type à "Demande d'intervention" -->
        <record id="action_open_demande_intervention" model="ir.actions.server">
            <field name="name">Demande d'intervention</field>
            <field name="model_id" ref="project_issue.model_project_issue"/>
            <field name="state">code</field>
            <field name="code">action = self.pool['project.issue'].ouvrir_demande_intervention(cr, uid, context)</field>
        </record>

        <record id="action_create_demande_intervention" model="ir.values">
            <field name="name">Demande d'intervention</field>
            <field name="key2">client_action_multi</field>
            <field name="model">project.issue</field>
            <field name="value" eval="'ir.actions.server,%d'%action_open_demande_intervention"/>
            <field name="object" eval="True"/>
        </record>


		<!-- *** Action dans vue parc installé (of.parc.installe) *** -->

		<!-- Lien pour action créer SAV depuis parc installé -->
        <record id="of_action_pi_open_creer_sav" model="ir.actions.server">
            <field name="name">Créer un SAV</field>
            <field name="model_id" ref="project_issue.model_project_issue"/>
            <field name="state">code</field>
            <field name="code">action = self.pool['of.parc.installe'].action_creer_sav(cr, uid, context)</field>
        </record>

        <record id="of_action_pi_creer_sav" model="ir.values">
            <field name="name">Créer un SAV</field>
            <field name="key2">client_action_multi</field>
            <field name="model">of.parc.installe</field>
            <field name="value" eval="'ir.actions.server,%d'%of_action_pi_open_creer_sav"/>
            <field name="object" eval="True"/>
        </record>
        
        
        <!-- *** Action dans vue partenaires (res.partner) *** -->

        <!-- Lien pour action créer SAV depuis une fiche client -->
        <record id="of_action_partner_open_creer_sav" model="ir.actions.server">
            <field name="name">Créer un SAV</field>
            <field name="model_id" ref="project_issue.model_project_issue"/>
            <field name="state">code</field>
            <field name="code">action = self.pool['res.partner'].action_creer_sav(cr, uid, context)</field>
        </record>

        <record id="action_creer_sav" model="ir.values">
            <field name="name">Créer un SAV</field>
            <field name="key2">client_action_multi</field>
            <field name="model">res.partner</field>
            <field name="value" eval="'ir.actions.server,%d'%of_action_partner_open_creer_sav"/>
            <field name="object" eval="True"/>
        </record>

    </data>
</openerp>