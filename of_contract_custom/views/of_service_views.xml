<?xml version="1.0" encoding="utf-8"?>
<odoo>

<!-- ******************************************************************************************* -->
<!-- ***************************************** SERVICE ***************************************** -->
<!-- ******************************************************************************************* -->

    <record id="of_contract_view_of_service_rec_filter" model="ir.ui.view">
        <field name="name">of.contract.view.of.service.rec.filter</field>
        <field name="model">of.service</field>
        <field name="inherit_id" ref="of_service.view_of_service_filter"/>
        <field name="arch" type="xml">
            <xpath expr="//search" position="inside">
                <field name="contract_line_id"/>
                <field name="contract_id"/>
            </xpath>
        </field>
    </record>

    <record id="view_of_contract_service_form" model="ir.ui.view">
        <field name="name">of.contract.service.form</field>
        <field name="model">of.service</field>
        <field name="inherit_id" ref="of_service.view_of_service_form"/>
        <field name="arch" type="xml">
            <xpath expr="//button[@name='button_brouillon']" position="after">
                <button name="transform_to_contract" string="Transformer" type="object" attrs="{'invisible': [('base_state', '!=', 'calculated')]}"/>
            </xpath>
            <xpath expr="//field[@name='order_id']" position="after">
                <field name="contract_id" attrs="{'invisible': ['|', ('type_id','not in',[%(of_service.of_service_type_maintenance)d, %(of_service_parc_installe.of_service_type_sav)d]), ('recurrence','=', True)]}"/>
                <field name="contract_line_id" context="{'display_address': True}" domain="[('contract_id', '=', contract_id)]"
                       attrs="{'invisible': ['|', '|', ('contract_id', '=', False), ('type_id','not in',[%(of_service.of_service_type_maintenance)d, %(of_service_parc_installe.of_service_type_sav)d]), ('recurrence','=', True)],
                               'required': [('contract_id', '!=', False)]}"/>
            </xpath>
            <xpath expr="//field[@name='recurrence']" position="attributes">
                <attribute name="attrs">{'invisible': ['|', '|', ('type_id','not in',[%(of_service.of_service_type_maintenance)d]), ('contract_id','!=', False), ('contract_line_id','!=', False)]}</attribute>
            </xpath>
            <xpath expr="//field[@name='recurrence']" position="after">
                <field name="contract_message" nolabel="1" colspan="2"/>
            </xpath>
            <xpath expr="//field[@name='employee_ids']" position="after">
                <field name="supplier_id"/>
            </xpath>
            <xpath expr="//field[@name='partner_id']" position="after">
                <field name="partner_code_magasin"/>
            </xpath>
        </field>
    </record>

</odoo>
