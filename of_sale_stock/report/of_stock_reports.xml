<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <template id="of_report_picking" inherit_id="stock.report_picking">
        <xpath expr="//table[@t-if='o.pack_operation_ids']/thead/tr" position="inside">
            <th name="operation_state">
                <strong>État</strong>
            </th>
        </xpath>
        <xpath expr="//table[@t-if='o.pack_operation_ids']/tbody/tr" position="inside">
            <td name="operation_state">
                <span t-field="pack_operation.move_state"/>
            </td>
        </xpath>
        <!-- Affichage conditionnel de la colonne description -->
        <xpath expr="//table[@t-if='o.pack_operation_ids']//th[1]" position="after">
            <th groups="of_sale_stock.group_description_BL_variant">
                <strong>Description</strong>
            </th>
        </xpath>
        <xpath expr="//table[@t-if='o.pack_operation_ids']//td[1]" position="after">
            <td groups="of_sale_stock.group_description_BL_variant">
                <span t-field="pack_operation.move_name"/>
            </td>
        </xpath>
    </template>

    <template id="report_of_picking_preparation">
        <t t-call="report.html_container">
            <t t-set="docs" t-value="docs.with_context(of_report_name='Bon de préparation')"/>
            <t t-foreach="docs" t-as="o">
                <t t-call="stock.report_picking" t-lang="o.partner_id.lang"/>
            </t>
        </t>
    </template>

    <report
        string="Picking Operations"
        id="stock.action_report_picking"
        model="stock.picking"
        report_type="qweb-pdf"
        name="stock.report_picking"
        file="of_sale_stock.report_of_picking_preparation"
    />

</odoo>
